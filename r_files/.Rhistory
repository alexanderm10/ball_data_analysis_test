axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="green") +
labs(x="Position", y="", fill="", title = "Turned Off") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
summary(rna.mean.stack.flower)
summary(nra.mean.stack.bud)
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="green") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="green") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(expand = c(0,0),breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(expand = c(0,0),breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
# The center of the distribution is just a flat out mess, but there are blips of blue around the 20 mark that merit investigation
# Pulling out the band of values at the top that are colored blue in the flower meaning they were turned on in teh bud and are not turned off
rna.mean.stack.flower <- rna.mean.stack[rna.mean.stack$type=="flower",]
summary(rna.mean.stack.flower)
rna.mean.stack.flower$gn.sig <- as.factor(ifelse(rna.mean.stack.flower$log2.value < -10 & rna.mean.stack.flower$reg == -1,"Y","N"))
summary(rna.mean.stack.flower)
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey50") +
geom_vline(aes(xintercept=pos, y=1), col="green") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
library(cowplot)
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
source('~/.active-rstudio-document', echo=TRUE)
datafile = read.table("input_data/test_gene_expression_matrix.txt", header=T, row.names = 1) # making column 1 row names
head(datafile)
summary(datafile)
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey45") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="green") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
library(cowplot)
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="forestgreen") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(expand=c(0,0),breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="forestgreen") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(expand = c(0,0), breaks  = seq(0,max(rna.mean.stack.flower$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.on <- ggplot(nra.mean.stack.bud[nra.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.bud$pos), by=10000))
rna.mean.stack.bud$pos
summary(nra.mean.stack.bud)
rna.mean.stack.bud <- rna.mean.stack[rna.mean.stack$type=="bud",]
summary(rna.mean.stack.bud)
rna.mean.stack.bud$gn.sig <- as.factor(ifelse(rna.mean.stack.bud$log2.value < -10 & rna.mean.stack.bud$reg == 1,"Y","N"))
summary(rna.mean.stack.bud)
gn.on <- ggplot(rna.mean.stack.bud[rna.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.bud$pos), by=10000))
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="forestgreen") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = seq(0,max(rna.mean.stack.bud$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
gn.on <- ggplot(rna.mean.stack.bud[rna.mean.stack.bud$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="purple") +
labs(x="Position", y="", fill="", title="Turned On", caption = "n = 99") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(limits = c(0,max(rna.mean.stack.bud$pos)),breaks  = seq(0,max(rna.mean.stack.bud$pos), by=10000))
gn.off <- ggplot(rna.mean.stack.flower[rna.mean.stack.flower$gn.sig=="Y",]) +
geom_hline(aes(, yintercept=1),lwd=1000, col="grey65") +
geom_vline(aes(xintercept=pos, y=1), col="forestgreen") +
labs(x="Position", y="", fill="", title = "Turned Off", caption ="n = 108") +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_blank(),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.title = element_text(size=22),
legend.key = element_rect(fill = "white")) +
guides(fill = guide_colourbar(barwidth = 15, barheight = 3,title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(limits = c(0,max(rna.mean.stack.bud$pos)),breaks  = seq(0,max(rna.mean.stack.bud$pos), by=10000))
png("figures/gene_onoff.png", height= 8, width = 15, res=300, unit = "in")
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
dev.off()
plotMD(efit)
dev.off()
dev.off()
plotMD(efit)
abline(h=c(-1,1), col="blue")
test <- as.data.frame(decideTests(efit))
test$gene <- as.factor(row.names(test))
summary(test)
up.reg <- test[test$conditionflower > 0,]
down.reg <- test[test$conditionflower < 0,]
summary(up.reg)
summary(down.reg)
ggplot(data=rna.mean.stack) +  facet_grid(type~.) +
geom_point(aes(x=pos, y=-log2.value, col=reg)) +
scale_color_manual(values=c("blue", "grey50", "red"))
plot_grid(gn.on,gn.off,align = c("v","h"), nrow = 2)
head(etable)
summary(decideTests(efit)) # about 4k down regulated; about 4k up regulated @ 0.05FDR
# Looking at which factors were significant
addmargins(table(sig_edgeR=etable$FDR<0.05))
108+99
